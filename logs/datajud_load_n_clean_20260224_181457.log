INFO [2026-02-24 18:14:57] Pipeline iniciado | log: D:/projetos/falimentar_tjpr_2026/logs/datajud_load_n_clean_20260224_181457.log
INFO [2026-02-24 18:14:58] SETUP | Iniciando configuração
INFO [2026-02-24 18:14:58] SETUP | Carregando pacotes via pacman
WARN [2026-02-24 18:14:58] SETUP | Pacotes ausentes serão instalados automaticamente — pode demorar
INFO [2026-02-24 18:15:03] SETUP | Pacotes carregados
INFO [2026-02-24 18:15:03] SETUP | Carregando funções auxiliares
INFO [2026-02-24 18:15:03] SETUP | Funções auxiliares carregadas
INFO [2026-02-24 18:15:03] LOAD | Iniciando carregamento dos dados
DEBUG [2026-02-24 18:15:03] CHECK | Verificando arquivos Parquet em data/parsed
DEBUG [2026-02-24 18:15:03] CHECK | Resultado da verificação de parquet:
            arquivo
  processos.parquet
 movimentos.parquet
   assuntos.parquet
                                                         caminho existe status
  D:/projetos/falimentar_tjpr_2026/data/parsed/processos.parquet   TRUE     OK
 D:/projetos/falimentar_tjpr_2026/data/parsed/movimentos.parquet   TRUE     OK
   D:/projetos/falimentar_tjpr_2026/data/parsed/assuntos.parquet   TRUE     OK
INFO [2026-02-24 18:15:03] CHECK | Todos os arquivos Parquet estão disponíveis
INFO [2026-02-24 18:15:03] LOAD | Conectando ao DuckDB e lendo parquet
INFO [2026-02-24 18:15:14] LOAD | Dados carregados | elapsed: 16.8s
INFO [2026-02-24 18:15:14] CHECK | Iniciando verificação de integridade
DEBUG [2026-02-24 18:15:14] CHECK | glimpse df_processos:
Rows: 61,471
Columns: 10
$ id                            <chr> "TJPR_G1_00169317820248160014", "TJPR_G1…
$ processo                      <chr> "00169317820248160014", "000079639202481…
$ classe_codigo                 <dbl> 108, 108, 108, 108, 108, 108, 108, 108, …
$ classe_nome                   <chr> "Falência de Empresários, Sociedades Emp…
$ data_ajuizamento              <chr> "2024-03-19T11:05:46.000Z", "2024-03-26T…
$ orgao_julgador_codigo         <dbl> 8799, 13752, 26422, 8809, 26404, 26404, …
$ orgao_julgador_nome           <chr> "LONDRINA - 10ª VARA CÍVEL", "CASCAVEL -…
$ orgao_julgador_municipio_ibge <dbl> 4113700, 4104808, 4106902, 4115200, 4106…
$ tribunal                      <chr> "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", …
$ grau                          <chr> "G1", "G1", "G1", "G1", "G1", "G1", "G1"…
DEBUG [2026-02-24 18:15:14] CHECK | glimpse df_movimentos:
Rows: 8,355,897
Columns: 9
$ id                    <chr> "TJPR_G1_00007963920248160192", "TJPR_G1_0000796…
$ processo              <chr> "00007963920248160192", "00007963920248160192", …
$ movimento_codigo      <chr> "85", "26", "123", "581", "581", "51", "51", "58…
$ movimento_nome        <chr> "Petição", "Distribuição", "Remessa", "Documento…
$ movimento_data_hora   <chr> "2024-03-26T16:19:18.000Z", "2024-03-26T16:19:20…
$ complemento_codigo    <dbl> 19, 2, 18, 4, 4, 3, 3, 4, 3, 4, 19, 3, 4, 3, 18,…
$ complemento_nome      <chr> "Petição inicial", "competência exclusiva", "em …
$ complemento_valor     <chr> "58", "1", "37", "116", "107", "6", "6", "107", …
$ complemento_descricao <chr> "tipo_de_peticao", "tipo_de_distribuicao_redistr…
DEBUG [2026-02-24 18:15:14] CHECK | glimpse df_assuntos:
Rows: 63,016
Columns: 4
$ id             <chr> "TJPR_G1_00169317820248160014", "TJPR_G1_00007963920248…
$ processo       <chr> "00169317820248160014", "00007963920248160192", "000001…
$ assunto_codigo <dbl> 4998, 4998, 4998, 9556, 4998, 4998, 9556, 5000, 9556, 5…
$ assunto_nome   <chr> "Autofalência", "Autofalência", "Autofalência", "Convol…
INFO [2026-02-24 18:15:14] CHECK | Verificando perfil de dados temporais
DEBUG [2026-02-24 18:15:14] CHECK | perfil data_ajuizamento (df_processos):
# A tibble: 2 × 3
  perfil                 n exemplos                                             
  <chr>              <int> <chr>                                                
1 num_yyyymmddhhmmss 60778 20230522230301 | 20250414151934 | 20240717171140 | 2…
2 iso8601_Z            693 2024-03-19T11:05:46.000Z | 2024-03-26T16:19:18.000Z …
DEBUG [2026-02-24 18:15:15] CHECK | perfil movimento_data_hora (df_movimentos) — pode levar tempo:
# A tibble: 1 × 3
  perfil          n exemplos                                                    
  <chr>       <int> <chr>                                                       
1 iso8601_Z 8355897 2024-03-26T16:19:18.000Z | 2024-03-26T16:19:20.000Z | 2024-…
INFO [2026-02-24 18:16:11] CHECK | Verificando dados faltantes (NA)
DEBUG [2026-02-24 18:16:12] CHECK | Tabela de NAs:
# A tibble: 3 × 6
  dataframe     n_linhas n_colunas n_celulas_na pct_celulas_na n_colunas_com_na
  <chr>            <int>     <int>        <dbl>          <dbl>            <int>
1 df_processos     61471        10            0          0                    0
2 df_movimentos  8355897         9     19760296          0.263                4
3 df_assuntos      63016         4            0          0                    0
WARN [2026-02-24 18:16:12] CHECK | NAs presentes | células ausentes: 19760296
INFO [2026-02-24 18:16:12] CHECK | Executando QA em df_processos e df_assuntos
DEBUG [2026-02-24 18:16:12] CHECK | Tabela QA crítica:
# A tibble: 2 × 7
  dataframe    linhas colunas linhas_com_na colunas_com_na celulas_na status
  <chr>         <int>   <int>         <int>          <int>      <int> <chr> 
1 df_processos  61471      10             0              0          0 OK    
2 df_assuntos   63016       4             0              0          0 OK    
INFO [2026-02-24 18:16:12] CHECK | QA OK: df_processos e df_assuntos sem NAs
INFO [2026-02-24 18:16:12] CHECK | Executando QA em df_movimentos
DEBUG [2026-02-24 18:16:14] CHECK | Tabela QA movimentos:
# A tibble: 1 × 9
  dataframe      linhas linhas_com_na_obrigatorio celulas_na_obrigatorio
  <chr>           <int>                     <int>                  <int>
1 df_movimentos 8355897                         0                      0
# ℹ 5 more variables: status_obrigatorio <chr>, linhas_sem_complemento <int>,
#   celulas_na_complemento <int>, status_complemento <chr>, mensagem <chr>
INFO [2026-02-24 18:16:14] CHECK | df_movimentos | Obrigatórias OK; 4940074 linhas sem complemento
INFO [2026-02-24 18:16:14] CHECK | QA OK: df_movimentos íntegro (NAs aceitos em complemento_*)
INFO [2026-02-24 18:16:14] CHECK | Verificações de integridade concluídas
INFO [2026-02-24 18:16:14] CLEAN | Iniciando limpeza dos dataframes
INFO [2026-02-24 18:16:14] CLEAN | df_processos | Ajustando tipos e variáveis temporais
INFO [2026-02-24 18:16:15] CLEAN | df_processos | Tipos ajustados e variáveis de data criadas
DEBUG [2026-02-24 18:16:15] CLEAN | df_processos | CHECK [1] tipo de data_ajuizamento_raw: character
DEBUG [2026-02-24 18:16:15] CLEAN | df_processos | data_ajuizamento_raw não é numérico (esperado)
INFO [2026-02-24 18:16:15] CLEAN | df_processos | CHECK [2] parse datas | total: 61471 | ok: 61471 | erro: 0
INFO [2026-02-24 18:16:15] CLEAN | df_processos | CHECK [3] intervalo data_ajuizamento | min: 1938-03-31 | max: 2025-12-31 17:08:00
DEBUG [2026-02-24 18:16:15] CLEAN | df_processos | CHECK [4] distribuição hora zero:
  eh_meianoite raw_meianoite      n percentual
1        FALSE         FALSE 35,831      58.3%
2         TRUE         FALSE 25,132      40.9%
3         TRUE          TRUE    508       0.8%
                                             significado
1            Data com hora na origem (datetime completo)
2   Data sem hora na origem (formato raw YYYYMMDD000000)
3 Data sem hora na origem (formato raw ISO com 00:00:00)
INFO [2026-02-24 18:16:15] CLEAN | df_processos | CHECK de datas concluído
INFO [2026-02-24 18:16:15] CLEAN | df_processos | ADD DATA | Consultando API IBGE para municípios
INFO [2026-02-24 18:16:22] CLEAN | df_processos | ADD DATA | API IBGE concluída | 142 municípios | elapsed: 84.3s
DEBUG [2026-02-24 18:16:22] CLEAN | df_processos | ADD DATA | municípios: Londrina, Cascavel, Curitiba, Maringá, Foz do Iguaçu, Ponta Grossa, Bocaiúva do Sul, Cambé, Campo Mourão, Formosa do Oeste, Mandaguari, Palmas, Siqueira Campos, Toledo, Nova Esperança, Palotina, Ibiporã, Rolândia, Medianeira, São José dos Pinhais, Arapongas, Pato Branco, Santa Mariana, Astorga, Capitão Leônidas Marques, Ibaiti, Pontal do Paraná, Guarapuava, Loanda, Reserva, Jaguapitã, Cianorte, Umuarama, Iporã, Palmeira, Araucária, Paranaguá, São Miguel do Iguaçu, Coronel Vivida, Pinhais, Francisco Beltrão, Apucarana, Sengés, Rio Negro, Paranavaí, Matinhos, Joaquim Távora, Irati, Jacarezinho, Marialva, Pérola, Cambará, Jaguariaíva, Sarandi, Chopinzinho, Cornélio Procópio, Sertanópolis, Ivaiporã, Lapa, União da Vitória, Colombo, Prudentópolis, Marilândia do Sul, Campina Grande do Sul, Telêmaco Borba, Laranjeiras do Sul, Piraquara, Goioerê, Colorado, Mallet, Paranacity, Marechal Cândido Rondon, Andirá, Almirante Tamandaré, Quedas do Iguaçu, Jandaia do Sul, Morretes, São Mateus do Sul, Faxinal, Clevelândia, Catanduvas, Campo Largo, Realeza, Castro, Nova Londrina, Bela Vista do Paraíso, Santo Antônio da Platina, Bandeirantes, Pitanga, Guaratuba, Santo Antônio do Sudoeste, São Jerônimo da Serra, Peabiru, Alto Piquiri, Curiúva, Imbituva, Engenheiro Beltrão, Dois Vizinhos, Paiçandu, Corbélia, Grandes Rios, Assaí, Rio Branco do Sul, Mandaguaçu, Congonhinhas, Palmital, Nova Fátima, Santa Isabel do Ivaí, Ribeirão do Pinhal, Mamborê, Centenário do Sul, Ubiratã, Barracão, Antonina, Matelândia, Porecatu, Cruzeiro do Oeste, Terra Rica, São João, Uraí, Fazenda Rio Grande, Salto do Lontra, Rebouças, Cidade Gaúcha, Marmeleiro, Mangueirinha, Guaíra, Terra Roxa, Pinhão, Campina da Lagoa, Cerro Azul, Terra Boa, Tomazina, Icaraíma, Assis Chateaubriand, Ampére, Piraí do Sul, Altônia, Santa Fé, Santa Helena, Wenceslau Braz, Manoel Ribas
INFO [2026-02-24 18:16:22] CLEAN | df_processos | Join IBGE concluído
DEBUG [2026-02-24 18:16:22] CLEAN | df_processos | glimpse pós-ajuste:
Rows: 61,471
Columns: 14
$ id                            <chr> "TJPR_G1_00169317820248160014", "TJPR_G1…
$ processo                      <chr> "00169317820248160014", "000079639202481…
$ classe_codigo                 <fct> 108, 108, 108, 108, 108, 108, 108, 108, …
$ classe_nome                   <fct> "Falência de Empresários, Sociedades Emp…
$ data_ajuizamento              <dttm> 2024-03-19 11:05:46, 2024-03-26 16:19:1…
$ orgao_julgador_codigo         <fct> 8799, 13752, 26422, 8809, 26404, 26404, …
$ orgao_julgador_nome           <fct> "LONDRINA - 10ª VARA CÍVEL", "CASCAVEL -…
$ orgao_julgador_municipio_ibge <int> 4113700, 4104808, 4106902, 4115200, 4106…
$ tribunal                      <fct> TJPR, TJPR, TJPR, TJPR, TJPR, TJPR, TJPR…
$ grau                          <fct> G1, G1, G1, G1, G1, G1, G1, G1, G1, G1, …
$ data_ajuizamento_raw          <chr> "2024-03-19T11:05:46.000Z", "2024-03-26T…
$ ano_ajuizamento               <dbl> 2024, 2024, 1984, 1996, 2005, 1995, 1995…
$ mes_ajuizamento               <dbl> 3, 3, 6, 4, 6, 8, 2, 6, 4, 12, 5, 4, 7, …
$ municipio_nome                <chr> "Londrina", "Cascavel", "Curitiba", "Mar…
INFO [2026-02-24 18:16:22] CLEAN | df_movimentos | Ajustando tipos e variáveis temporais
INFO [2026-02-24 18:17:36] CLEAN | df_movimentos | Tipos ajustados e variáveis de data criadas
DEBUG [2026-02-24 18:17:36] CLEAN | df_movimentos | CHECK [1] tipo de movimento_data_hora: POSIXct, POSIXt
DEBUG [2026-02-24 18:17:36] CLEAN | df_movimentos | movimento_data_hora não é numérico (esperado)
INFO [2026-02-24 18:17:36] CLEAN | df_movimentos | CHECK [2] parse datas | total: 8355897 | ok: 8355897 | erro: 0
INFO [2026-02-24 18:17:37] CLEAN | df_movimentos | CHECK [3] intervalo movimento_data_hora | min: 1967-06-06 | max: 2026-01-31 21:53:32
DEBUG [2026-02-24 18:18:09] CLEAN | df_movimentos | CHECK [4] distribuição hora zero:
  eh_meianoite raw_meianoite         n percentual
1        FALSE         FALSE 8,353,550     100.0%
2         TRUE          TRUE     2,347       0.0%
                                             significado
1            Data com hora na origem (datetime completo)
2 Data sem hora na origem (formato raw ISO com 00:00:00)
INFO [2026-02-24 18:18:09] CLEAN | df_movimentos | CHECK de datas concluído
DEBUG [2026-02-24 18:18:09] CLEAN | df_movimentos | glimpse pós-ajuste:
Rows: 8,355,897
Columns: 12
$ id                      <chr> "TJPR_G1_00007963920248160192", "TJPR_G1_00007…
$ processo                <chr> "00007963920248160192", "00007963920248160192"…
$ movimento_codigo        <fct> 85, 26, 123, 581, 581, 51, 51, 581, 51, 60, 85…
$ movimento_nome          <fct> "Petição", "Distribuição", "Remessa", "Documen…
$ movimento_data_hora     <dttm> 2024-03-26 16:19:18, 2024-03-26 16:19:20, 202…
$ complemento_codigo      <fct> 19, 2, 18, 4, 4, 3, 3, 4, 3, 4, 19, 3, 4, 3, 1…
$ complemento_nome        <fct> Petição inicial, competência exclusiva, em dil…
$ complemento_valor       <fct> 58, 1, 37, 116, 107, 6, 6, 107, 6, 80, 57, 6, …
$ complemento_descricao   <fct> tipo_de_peticao, tipo_de_distribuicao_redistri…
$ movimento_data_hora_raw <chr> "2024-03-26T16:19:18.000Z", "2024-03-26T16:19:…
$ movimento_mes           <dttm> 2024-03-01, 2024-03-01, 2024-03-01, 2024-03-0…
$ movimento_ano           <dbl> 2024, 2024, 2024, 2024, 2024, 2024, 2024, 2024…
INFO [2026-02-24 18:18:09] CLEAN | df_assuntos | Ajustando tipos
INFO [2026-02-24 18:18:09] CLEAN | df_assuntos | Tipos ajustados
DEBUG [2026-02-24 18:18:09] CLEAN | df_assuntos | glimpse pós-ajuste:
Rows: 63,016
Columns: 4
$ id             <chr> "TJPR_G1_00169317820248160014", "TJPR_G1_00007963920248…
$ processo       <chr> "00169317820248160014", "00007963920248160192", "000001…
$ assunto_codigo <fct> 4998, 4998, 4998, 9556, 4998, 4998, 9556, 5000, 9556, 5…
$ assunto_nome   <fct> "Autofalência", "Autofalência", "Autofalência", "Convol…
INFO [2026-02-24 18:18:09] CLEAN | Limpeza dos dataframes concluída
INFO [2026-02-24 18:18:09] OUTPUT | Verificando exportação dos dataframes limpos
INFO [2026-02-24 18:18:09] OUTPUT | Sessão não interativa: salvamento automático desativado (padrão = NÃO)
INFO [2026-02-24 18:18:09] OUTPUT | Salvamento ignorado — dados disponíveis apenas no ambiente da sessão
INFO [2026-02-24 18:18:09] Pipeline encerrado com sucesso | elapsed total: 192.17s | fim: 2026-02-24 18:18:09
