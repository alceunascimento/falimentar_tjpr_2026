INFO [2026-02-24 19:10:20] Pipeline iniciado
INFO [2026-02-24 19:10:20] SETUP | Iniciando configuração
INFO [2026-02-24 19:10:20] SETUP | Carregando pacotes via pacman
WARN [2026-02-24 19:10:20] SETUP | Pacotes ausentes serão instalados automaticamente (pode demorar)
WARN [2026-02-24 19:10:20] SETUP | Se tiver que instarlar o duckdb vai demorar bastante, aguarde com paciência
INFO [2026-02-24 19:10:20] SETUP | Pacotes carregados
INFO [2026-02-24 19:10:20] SETUP | Carregando funções auxiliares
INFO [2026-02-24 19:10:20] SETUP | Funções auxiliares carregadas
INFO [2026-02-24 19:10:20] LOAD | Iniciando carregamento dos dados
DEBUG [2026-02-24 19:10:20] CHECK | Verificando arquivos Parquet em data/parsed
DEBUG [2026-02-24 19:10:21] CHECK | Resultado da verificação de parquet:
            arquivo                                                         caminho existe status
  processos.parquet  D:/projetos/falimentar_tjpr_2026/data/parsed/processos.parquet   TRUE     OK
 movimentos.parquet D:/projetos/falimentar_tjpr_2026/data/parsed/movimentos.parquet   TRUE     OK
   assuntos.parquet   D:/projetos/falimentar_tjpr_2026/data/parsed/assuntos.parquet   TRUE     OK
INFO [2026-02-24 19:10:21] CHECK | Todos os arquivos Parquet estão disponíveis
INFO [2026-02-24 19:10:21] LOAD | Conectando ao DuckDB e lendo parquet
INFO [2026-02-24 19:10:28] LOAD | Dados carregados | tempo gasto: 7.7s
INFO [2026-02-24 19:10:28] CHECK | Iniciando verificação de integridade
DEBUG [2026-02-24 19:10:28] CHECK | glimpse df_processos:
Rows: 61,471
Columns: 10
$ id                            <chr> "TJPR_G1_00169317820248160014", "TJPR_G1_00007963920248160192", "TJPR_G1_00000116519848160035", "TJPR_G1_00003419619968160017", "TJPR_G1_000…
$ processo                      <chr> "00169317820248160014", "00007963920248160192", "00000116519848160035", "00003419619968160017", "00082026420058160035", "0000433541995816003…
$ classe_codigo                 <dbl> 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, 108, …
$ classe_nome                   <chr> "Falência de Empresários, Sociedades Empresáriais, Microempresas e Empresas de Pequeno Porte", "Falência de Empresários, Sociedades Empresár…
$ data_ajuizamento              <chr> "2024-03-19T11:05:46.000Z", "2024-03-26T16:19:18.000Z", "1984-06-08T00:00:00.000Z", "1996-04-18T00:00:00.000Z", "2005-06-02T00:00:00.000Z", …
$ orgao_julgador_codigo         <dbl> 8799, 13752, 26422, 8809, 26404, 26404, 8892, 26422, 8816, 26422, 26422, 8816, 8809, 26422, 26404, 26404, 13950, 8988, 8809, 8809, 8809, 880…
$ orgao_julgador_nome           <chr> "LONDRINA - 10ª VARA CÍVEL", "CASCAVEL - 4ª VARA CÍVEL", "CURITIBA - 2ª VARA DE FALÊNCIAS E RECUPERAÇÕES JUDICIAIS", "MARINGÁ - 3ª VARA CÍVE…
$ orgao_julgador_municipio_ibge <dbl> 4113700, 4104808, 4106902, 4115200, 4106902, 4106902, 4108304, 4106902, 4119905, 4106902, 4106902, 4119905, 4115200, 4106902, 4106902, 41069…
$ tribunal                      <chr> "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJPR", "TJP…
$ grau                          <chr> "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G1", "G…
DEBUG [2026-02-24 19:10:28] CHECK | glimpse df_movimentos:
Rows: 8,355,897
Columns: 9
$ id                    <chr> "TJPR_G1_00007963920248160192", "TJPR_G1_00007963920248160192", "TJPR_G1_00007963920248160192", "TJPR_G1_00007963920248160192", "TJPR_G1_00007963920…
$ processo              <chr> "00007963920248160192", "00007963920248160192", "00007963920248160192", "00007963920248160192", "00007963920248160192", "00007963920248160192", "000…
$ movimento_codigo      <chr> "85", "26", "123", "581", "581", "51", "51", "581", "51", "60", "85", "51", "60", "51", "123", "36", "85", "51", "60", "85", "123", "26", "581", "60…
$ movimento_nome        <chr> "Petição", "Distribuição", "Remessa", "Documento", "Documento", "Conclusão", "Conclusão", "Documento", "Conclusão", "Expedição de documento", "Petiç…
$ movimento_data_hora   <chr> "2024-03-26T16:19:18.000Z", "2024-03-26T16:19:20.000Z", "2024-03-26T16:19:20.000Z", "2024-03-26T17:23:06.000Z", "2024-03-26T17:56:21.000Z", "2024-03…
$ complemento_codigo    <dbl> 19, 2, 18, 4, 4, 3, 3, 4, 3, 4, 19, 3, 4, 3, 18, 2, 19, 3, 4, 19, 18, 2, 4, 4, 4, 4, 3, 4, 19, 4, 4, 19, 4, 4, 4, 4, 4, 3, 4, 4, 3, 4, 19, 4, 18, 4,…
$ complemento_nome      <chr> "Petição inicial", "competência exclusiva", "em diligência", "Informações", "Certidão", "para decisão", "para decisão", "Certidão", "para decisão", …
$ complemento_valor     <chr> "58", "1", "37", "116", "107", "6", "6", "107", "6", "80", "57", "6", "80", "5", "37", "2", "57", "5", "80", "58", "37", "2", "80", "80", "80", "80"…
$ complemento_descricao <chr> "tipo_de_peticao", "tipo_de_distribuicao_redistribuicao", "motivo_da_remessa", "tipo_de_documento", "tipo_de_documento", "tipo_de_conclusao", "tipo_…
DEBUG [2026-02-24 19:10:28] CHECK | glimpse df_assuntos:
Rows: 63,016
Columns: 4
$ id             <chr> "TJPR_G1_00169317820248160014", "TJPR_G1_00007963920248160192", "TJPR_G1_00000116519848160035", "TJPR_G1_00003419619968160017", "TJPR_G1_000820264200581600…
$ processo       <chr> "00169317820248160014", "00007963920248160192", "00000116519848160035", "00003419619968160017", "00082026420058160035", "00004335419958160035", "0000908251…
$ assunto_codigo <dbl> 4998, 4998, 4998, 9556, 4998, 4998, 9556, 5000, 9556, 5000, 4998, 7703, 9556, 4998, 4998, 4998, 9556, 4998, 4998, 9607, 4998, 4998, 4998, 4998, 9558, 11783…
$ assunto_nome   <chr> "Autofalência", "Autofalência", "Autofalência", "Convolação de recuperação judicial em falência", "Autofalência", "Autofalência", "Convolação de recuperaçã…
INFO [2026-02-24 19:10:28] CHECK | Verificando perfil de dados temporais
DEBUG [2026-02-24 19:10:28] CHECK | perfil data_ajuizamento (df_processos):
# A tibble: 2 × 3
  perfil                 n exemplos                                                                                                                            
  <chr>              <int> <chr>                                                                                                                               
1 num_yyyymmddhhmmss 60778 20230522230301 | 20250414151934 | 20240717171140 | 20020926000000 | 20041202000000                                                  
2 iso8601_Z            693 2024-03-19T11:05:46.000Z | 2024-03-26T16:19:18.000Z | 1984-06-08T00:00:00.000Z | 1996-04-18T00:00:00.000Z | 2005-06-02T00:00:00.000Z
DEBUG [2026-02-24 19:10:29] CHECK | perfil movimento_data_hora (df_movimentos):
# A tibble: 1 × 3
  perfil          n exemplos                                                                                                                            
  <chr>       <int> <chr>                                                                                                                               
1 iso8601_Z 8355897 2024-03-26T16:19:18.000Z | 2024-03-26T16:19:20.000Z | 2024-03-26T17:23:06.000Z | 2024-03-26T17:56:21.000Z | 2024-03-27T01:07:33.000Z
INFO [2026-02-24 19:11:23] CHECK | Verificando dados faltantes (NA)
DEBUG [2026-02-24 19:11:23] CHECK | Tabela de NAs:
# A tibble: 3 × 6
  dataframe     n_linhas n_colunas n_celulas_na pct_celulas_na n_colunas_com_na
  <chr>            <int>     <int>        <dbl>          <dbl>            <int>
1 df_processos     61471        10            0          0                    0
2 df_movimentos  8355897         9     19760296          0.263                4
3 df_assuntos      63016         4            0          0                    0
WARN [2026-02-24 19:11:24] CHECK | NAs presentes | células ausentes: 19760296
INFO [2026-02-24 19:11:24] CHECK | Executando QA em df_processos e df_assuntos
DEBUG [2026-02-24 19:11:24] CHECK | Tabela QA crítica:
# A tibble: 2 × 7
  dataframe    linhas colunas linhas_com_na colunas_com_na celulas_na status
  <chr>         <int>   <int>         <int>          <int>      <int> <chr> 
1 df_processos  61471      10             0              0          0 OK    
2 df_assuntos   63016       4             0              0          0 OK    
INFO [2026-02-24 19:11:24] CHECK | QA OK: df_processos e df_assuntos sem NAs
INFO [2026-02-24 19:11:24] CHECK | Executando QA em df_movimentos
DEBUG [2026-02-24 19:11:26] CHECK | Tabela QA movimentos:
# A tibble: 1 × 9
  dataframe      linhas linhas_com_na_obrigatorio celulas_na_obrigatorio status_obrigatorio linhas_sem_complemento celulas_na_complemento status_complemento mensagem               
  <chr>           <int>                     <int>                  <int> <chr>                               <int>                  <int> <chr>              <chr>                  
1 df_movimentos 8355897                         0                      0 OK                                4940074               19760296 OK                 Obrigatórias OK; 49400…
INFO [2026-02-24 19:11:27] CHECK | df_movimentos | Obrigatórias OK; 4940074 linhas sem complemento
INFO [2026-02-24 19:11:27] CHECK | QA OK: df_movimentos íntegro (NAs aceitos em complemento_*)
INFO [2026-02-24 19:11:27] CHECK | Verificações de integridade concluídas
INFO [2026-02-24 19:11:27] CLEAN | Iniciando limpeza dos dataframes
INFO [2026-02-24 19:11:27] CLEAN | df_processos | Ajustando tipos e variáveis temporais
